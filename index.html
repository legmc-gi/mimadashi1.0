<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¯†ç å¤§å¸ˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            outline: none;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: white;
            color: #333;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        /* ç¦æ­¢é€‰æ‹©é™¤ç‰¹å®šå…ƒç´ å¤–çš„æ–‡æœ¬ */
        input, textarea, .password-display, .copyable-text {
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
            user-select: text;
        }

        .container {
            flex: 1;
            padding: 20px;
            padding-bottom: 80px;
            overflow-y: auto;
        }

        /* æ ‡ç­¾æ æ ·å¼ */
        .tab-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            border-top: 1px solid #e0e0e0;
            display: flex;
            height: 80px;
            z-index: 1000;
        }

        .tab-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .tab-item.active {
            color: #007AFF;
        }

        .tab-icon {
            font-size: 24px;
            margin-bottom: 4px;
            transition: transform 0.3s ease;
        }

        .tab-label {
            font-size: 12px;
        }

        /* é¡µé¢åˆ‡æ¢åŠ¨ç”» */
        .page {
            display: none;
            animation: fadeIn 0.3s ease-in-out;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* é¦–é¡µæ ·å¼ */
        .home-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .home-title {
            font-size: 32px;
            font-weight: bold;
            color: #333;
            margin-bottom: 8px;
        }

        .home-subtitle {
            color: #666;
            font-size: 16px;
        }

        .password-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.1);
            border: 1px solid #f0f0f0;
            animation: slideInUp 0.3s ease-out;
        }

        @keyframes slideInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }

        .site-name {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
        }

        .delete-btn {
            background: #ff4757;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 6px 12px;
            font-size: 12px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .delete-btn:hover {
            background: #ff3742;
        }

        .password-info {
            font-size: 14px;
            color: #666;
            margin-bottom: 12px;
        }

        .password-display {
            font-family: 'Courier New', monospace;
            font-size: 16px;
            font-weight: bold;
            background: #f8f9fa;
            padding: 8px 12px;
            border-radius: 8px;
            margin-bottom: 12px;
            word-break: break-all;
            border: 1px solid #e9ecef;
        }

        .card-actions {
            display: flex;
            gap: 8px;
        }

        .action-btn {
            flex: 1;
            padding: 8px 16px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: white;
            color: #333;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .action-btn.primary {
            background: #007AFF;
            color: white;
            border-color: #007AFF;
        }

        .action-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }

        /* åˆ›å»ºå¯†ç æ¨¡æ€æ¡† */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 16px;
            padding: 24px;
            width: 90%;
            max-width: 400px;
            max-height: 80vh;
            overflow-y: auto;
            animation: scaleIn 0.3s ease;
        }

        @keyframes scaleIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            background: white;
            transition: border-color 0.3s ease;
        }

        .form-input:focus {
            border-color: #007AFF;
            box-shadow: 0 0 0 3px rgba(0,122,255,0.1);
        }

        .password-strength {
            margin-top: 8px;
            font-size: 14px;
        }

        .strength-weak { color: #ff4757; }
        .strength-medium { color: #ffa502; }
        .strength-strong { color: #2ed573; }

        .modal-actions {
            display: flex;
            gap: 12px;
            margin-top: 24px;
        }

        .modal-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .modal-btn.primary {
            background: #007AFF;
            color: white;
        }

        .modal-btn.secondary {
            background: #f1f3f4;
            color: #333;
        }

        /* éšæœºå¯†ç é¡µé¢ */
        .random-password-container {
            text-align: center;
            padding: 40px 20px;
        }

        .generate-btn {
            background: linear-gradient(135deg, #007AFF, #5856D6);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 16px 32px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin: 20px 0;
            transition: transform 0.3s ease;
        }

        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,122,255,0.3);
        }

        .generated-password {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            font-size: 20px;
            font-weight: bold;
            word-break: break-all;
            text-align: left;
        }

        .save-random-prompt {
            background: #e8f5e8;
            border: 1px solid #4CAF50;
            border-radius: 12px;
            padding: 16px;
            margin: 16px 0;
            text-align: left;
        }

        .save-random-buttons {
            display: flex;
            gap: 12px;
            margin-top: 12px;
        }

        /* è®¾ç½®é¡µé¢ */
        .settings-container {
            padding: 20px;
        }

        .setting-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .setting-label {
            font-size: 16px;
            color: #333;
        }

        .setting-value {
            font-size: 14px;
            color: #666;
        }

        .setting-btn {
            padding: 8px 16px;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: white;
            color: #333;
            font-size: 14px;
            cursor: pointer;
        }

        /* åè®®å¼¹çª— */
        .agreement-modal {
            max-width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .agreement-content {
            line-height: 1.6;
            font-size: 14px;
            color: #333;
        }

        .agreement-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 16px;
            text-align: center;
        }

        .agreement-buttons {
            display: flex;
            gap: 12px;
            margin-top: 24px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }

        /* åŠ¨ç”» */
        @keyframes slideInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 480px) {
            .container {
                padding: 16px;
                padding-bottom: 80px;
            }
            
            .password-card {
                padding: 16px;
            }
            
            .modal-content {
                margin: 20px;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- é¦–é¡µ -->
    <div id="homePage" class="page active">
        <div class="home-header">
            <h1 class="home-title">å¯†ç å¤§å¸ˆ</h1>
            <p class="home-subtitle">å®‰å…¨å­˜å‚¨æ‚¨çš„å¯†ç </p>
        </div>
        
        <div id="passwordList">
            <!-- å¯†ç å¡ç‰‡å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
        </div>
        
        <button id="addPasswordBtn" class="modal-btn primary" style="position: fixed; bottom: 100px; right: 20px; width: 56px; height: 56px; border-radius: 50%; font-size: 24px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 12px rgba(0,122,255,0.3);">
            +
        </button>
    </div>

    <!-- éšæœºå¯†ç é¡µé¢ -->
    <div id="randomPage" class="page">
        <div class="random-password-container">
            <h2 style="margin-bottom: 20px; color: #333;">ç”Ÿæˆéšæœºå¯†ç </h2>
            <button id="generatePasswordBtn" class="generate-btn">ç”Ÿæˆå®‰å…¨å¯†ç </button>
            
            <div id="generatedPasswordContainer" style="display: none;">
                <div class="generated-password" id="generatedPassword"></div>
                <div class="save-random-prompt">
                    <strong>æ˜¯å¦ä¿å­˜æ­¤å¯†ç ï¼Ÿ</strong>
                    <div style="font-size: 14px; color: #666; margin-top: 8px;">
                        ä¿å­˜åå¯åœ¨é¦–é¡µæŸ¥çœ‹å’Œç®¡ç†
                    </div>
                </div>
                <div class="save-random-buttons">
                    <button id="saveRandomPasswordBtn" class="modal-btn primary">ä¿å­˜å¯†ç </button>
                    <button id="dontSaveRandomBtn" class="modal-btn secondary">æš‚ä¸ä¿å­˜</button>
                </div>
            </div>
        </div>
    </div>

    <!-- è®¾ç½®é¡µé¢ -->
    <div id="settingsPage" class="page">
        <div class="settings-container">
            <div class="setting-item">
                <span class="setting-label">æ£€æŸ¥æ›´æ–°</span>
                <button id="checkUpdateBtn" class="setting-btn">æ£€æŸ¥</button>
            </div>
            <div class="setting-item">
                <span class="setting-label">å…³äº</span>
                <span class="setting-value">ç‰ˆæœ¬ 1.0</span>
            </div>
        </div>
    </div>

    <!-- æ ‡ç­¾æ  -->
    <div class="tab-bar">
        <div class="tab-item active" data-page="home">
            <div class="tab-icon">ğŸ </div>
            <div class="tab-label">é¦–é¡µ</div>
        </div>
        <div class="tab-item" data-page="random">
            <div class="tab-icon">ğŸ²</div>
            <div class="tab-label">éšæœºå¯†ç </div>
        </div>
        <div class="tab-item" data-page="settings">
            <div class="tab-icon">âš™ï¸</div>
            <div class="tab-label">è®¾ç½®</div>
        </div>
    </div>

    <!-- åˆ›å»ºå¯†ç æ¨¡æ€æ¡† -->
    <div id="createPasswordModal" class="modal">
        <div class="modal-content">
            <h3 style="margin-bottom: 20px; text-align: center;">åˆ›å»ºæ–°å¯†ç </h3>
            <form id="passwordForm">
                <div class="form-group">
                    <label class="form-label">ç½‘ç«™/åº”ç”¨åç§° *</label>
                    <input type="text" id="siteName" class="form-input" placeholder="ä¾‹å¦‚ï¼šå¾®ä¿¡ã€æ·˜å®ã€é“¶è¡ŒAPP" required>
                </div>
                <div class="form-group">
                    <label class="form-label">ç”¨æˆ·å/é‚®ç®± *</label>
                    <input type="text" id="username" class="form-input" placeholder="è¾“å…¥ç”¨æˆ·åæˆ–é‚®ç®±" required>
                </div>
                <div class="form-group">
                    <label class="form-label">å¯†ç  *</label>
                    <input type="password" id="password" class="form-input" placeholder="è¾“å…¥å¯†ç " required>
                </div>
                <div class="form-group">
                    <label class="form-label">å¤‡æ³¨ï¼ˆå¯é€‰ï¼‰</label>
                    <input type="text" id="notes" class="form-input" placeholder="æ·»åŠ å¤‡æ³¨ä¿¡æ¯">
                </div>
                <div class="password-strength" id="passwordStrength"></div>
                <div class="modal-actions">
                    <button type="button" id="cancelBtn" class="modal-btn secondary">å–æ¶ˆ</button>
                    <button type="submit" class="modal-btn primary">ä¿å­˜</button>
                </div>
            </form>
        </div>
    </div>

    <!-- åè®®æ¨¡æ€æ¡† -->
    <div id="agreementModal" class="modal agreement-modal">
        <div class="modal-content">
            <div id="agreementContent" class="agreement-content">
                <!-- åè®®å†…å®¹å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
            </div>
            <div class="agreement-buttons">
                <button id="agreeBtn" class="modal-btn primary">åŒæ„å¹¶ç»§ç»­</button>
                <button id="disagreeBtn" class="modal-btn secondary">æ‹’ç»</button>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let passwords = JSON.parse(localStorage.getItem('passwords')) || [];
        let isAgreementAccepted = localStorage.getItem('agreementAccepted') === 'true';
        let currentEditingPassword = null;

        // åˆå§‹åŒ–åº”ç”¨
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            if (!isAgreementAccepted) {
                showAgreementModal();
            } else {
                setupEventListeners();
                renderPasswords();
                updateTabBar();
            }
        }

        // æ˜¾ç¤ºåè®®æ¨¡æ€æ¡†
        function showAgreementModal() {
            const modal = document.getElementById('agreementModal');
            const content = document.getElementById('agreementContent');
            
            content.innerHTML = `
                <div class="agreement-title">æ¬¢è¿ä½¿ç”¨å¯†ç å¤§å¸ˆ</div>
                <div style="margin-bottom: 20px;">
                    <strong>è¯·ä»”ç»†é˜…è¯»å¹¶åŒæ„ä»¥ä¸‹åè®®ä»¥ç»§ç»­ä½¿ç”¨æœ¬åº”ç”¨</strong>
                </div>
                <div style="margin-bottom: 20px;">
                    <button id="showPrivacyBtn" class="modal-btn secondary" style="width: auto; padding: 8px 16px; font-size: 14px;">æŸ¥çœ‹éšç§åè®®</button>
                    <button id="showUserBtn" class="modal-btn secondary" style="width: auto; padding: 8px 16px; font-size: 14px; margin-left: 8px;">æŸ¥çœ‹ç”¨æˆ·åè®®</button>
                </div>
                <div id="agreementText">
                    <div style="background: #f8f9fa; padding: 16px; border-radius: 8px; margin-bottom: 16px;">
                        <strong style="color: #d32f2f;">é‡è¦æé†’ï¼š</strong><br>
                        æœ¬åº”ç”¨ä»…ä¾›å­¦ä¹ å’Œæ¼”ç¤ºä½¿ç”¨ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¯·ä½¿ç”¨ä¸“ä¸šçš„å¯†ç ç®¡ç†å·¥å…·ã€‚<br>
                        è¯·å‹¿åœ¨æ­¤åº”ç”¨ä¸­å­˜å‚¨æå…¶é‡è¦çš„å¯†ç ä¿¡æ¯ã€‚
                    </div>
                    <div>
                        <strong>éšç§æ”¿ç­–æ‘˜è¦ï¼š</strong><br>
                        â€¢ æ‚¨çš„å¯†ç æ•°æ®ä»…å­˜å‚¨åœ¨æœ¬åœ°è®¾å¤‡ä¸Šï¼Œæˆ‘ä»¬ä¸ä¼šæ”¶é›†ã€ä¼ è¾“æˆ–åˆ†äº«æ‚¨çš„ä»»ä½•ä¸ªäººä¿¡æ¯<br>
                        â€¢ æ‰€æœ‰æ•°æ®æœ¬åœ°å‚¨å­˜<br>
                        â€¢ æˆ‘ä»¬é‡è§†æ‚¨çš„éšç§ï¼Œæ‰¿è¯ºä¸ä¼šä»¥ä»»ä½•å½¢å¼ä¾µçŠ¯æ‚¨çš„éšç§æƒ
                    </div>
                    <div style="margin-top: 16px;">
                        <strong>ç”¨æˆ·åè®®æ‘˜è¦ï¼š</strong><br>
                        â€¢ æ‚¨åŒæ„è‡ªè¡Œæ‰¿æ‹…ä½¿ç”¨æœ¬åº”ç”¨çš„é£é™©<br>
                        â€¢ æœ¬åº”ç”¨ä¸ä¿è¯æ•°æ®çš„ç»å¯¹å®‰å…¨æ€§<br>
                        â€¢ è¯·å¦¥å–„ä¿ç®¡æ‚¨çš„è®¾å¤‡ï¼Œé˜²æ­¢ä»–äººæœªç»æˆæƒè®¿é—®<br>
                        â€¢ ç¦æ­¢å°†æœ¬åº”ç”¨ç”¨äºéæ³•ç”¨é€”
                    </div>
                </div>
            `;
            
            modal.classList.add('active');
            
            // ç»‘å®šåè®®æŸ¥çœ‹æŒ‰é’®
            document.getElementById('showPrivacyBtn').addEventListener('click', () => showFullAgreement('privacy'));
            document.getElementById('showUserBtn').addEventListener('click', () => showFullAgreement('user'));
            
            // ç»‘å®šåŒæ„/æ‹’ç»æŒ‰é’®
            document.getElementById('agreeBtn').addEventListener('click', acceptAgreement);
            document.getElementById('disagreeBtn').addEventListener('click', disagreeAgreement);
        }

        function showFullAgreement(type) {
            const text = document.getElementById('agreementText');
            let content = '';
            
            if (type === 'privacy') {
                content = `
                    <div class="agreement-title">éšç§åè®®</div>
                    <div style="line-height: 1.8; margin-top: 16px;">
                        <h4 style="color: #333; margin: 16px 0 8px 0;">1. ä¿¡æ¯æ”¶é›†</h4>
                        <p>æœ¬åº”ç”¨ä¸ä¼šæ”¶é›†æ‚¨çš„ä»»ä½•ä¸ªäººä¿¡æ¯ï¼ŒåŒ…æ‹¬å§“åã€é‚®ç®±ã€ç”µè¯å·ç ç­‰ã€‚æ‰€æœ‰å¯†ç æ•°æ®éƒ½å­˜å‚¨åœ¨æ‚¨çš„æœ¬åœ°è®¾å¤‡ä¸Šã€‚</p>
                        
                        <h4 style="color: #333; margin: 16px 0 8px 0;">2. æ•°æ®å­˜å‚¨</h4>
                        <p>æ‚¨çš„å¯†ç æ•°æ®å­˜å‚¨åœ¨æ‚¨çš„è®¾å¤‡ä¸Šï¼Œæˆ‘ä»¬æ— æ³•è®¿é—®è¿™äº›æ•°æ®ã€‚æ•°æ®ä»…åœ¨æ‚¨çš„è®¾å¤‡ä¸Šå¯ç”¨ï¼Œä¸ä¼šä¸Šä¼ åˆ°ä»»ä½•æœåŠ¡å™¨ã€‚</p>
                        
                        <h4 style="color: #333; margin: 16px 0 8px 0;">3. æ•°æ®å®‰å…¨</h4>
                        <p>æˆ‘ä»¬å»ºè®®æ‚¨è®¾ç½®è®¾å¤‡å¯†ç æˆ–ç”Ÿç‰©è¯†åˆ«ä¿æŠ¤ï¼Œä»¥é˜²æ­¢ä»–äººæœªç»æˆæƒè®¿é—®æ‚¨çš„è®¾å¤‡ã€‚è¯·å¦¥å–„ä¿ç®¡æ‚¨çš„ä¸»å¯†ç ã€‚</p>
                        
                        <h4 style="color: #333; margin: 16px 0 8px 0;">4. æ•°æ®æ‰€æœ‰æƒ</h4>
                        <p>æ‚¨å­˜å‚¨çš„æ‰€æœ‰æ•°æ®éƒ½å½’æ‚¨æ‰€æœ‰ï¼Œæˆ‘ä»¬ä¸ä¼šå¯¹æ‚¨çš„æ•°æ®è¿›è¡Œä»»ä½•å½¢å¼çš„å•†ä¸šåˆ©ç”¨ã€‚</p>
                        
                        <h4 style="color: #333; margin: 16px 0 8px 0;">5. ç¬¬ä¸‰æ–¹åˆ†äº«</h4>
                        <p>æˆ‘ä»¬ä¸ä¼šä¸ä»»ä½•ç¬¬ä¸‰æ–¹åˆ†äº«æ‚¨çš„ä¸ªäººä¿¡æ¯æˆ–å¯†ç æ•°æ®ã€‚</p>
                    </div>
                `;
            } else {
                content = `
                    <div class="agreement-title">ç”¨æˆ·åè®®</div>
                    <div style="line-height: 1.8; margin-top: 16px;">
                        <h4 style="color: #333; margin: 16px 0 8px 0;">1. ä½¿ç”¨æ¡æ¬¾</h4>
                        <p>æ‚¨åŒæ„ä»…å°†æœ¬åº”ç”¨ç”¨äºåˆæ³•ç›®çš„ï¼Œä¸å¾—åˆ©ç”¨æœ¬åº”ç”¨ä»äº‹ä»»ä½•è¿æ³•æ´»åŠ¨ã€‚</p>
                        
                        <h4 style="color: #333; margin: 16px 0 8px 0;">2. å…è´£å£°æ˜</h4>
                        <p>æœ¬åº”ç”¨ä»…ä¾›å­¦ä¹ å’Œæ¼”ç¤ºä½¿ç”¨ï¼Œä¸æä¾›ä¸“ä¸šçº§çš„å®‰å…¨ä¿éšœã€‚æˆ‘ä»¬ä¸å¯¹å› ä½¿ç”¨æœ¬åº”ç”¨è€Œå¯¼è‡´çš„ä»»ä½•æŸå¤±æ‰¿æ‹…è´£ä»»ã€‚</p>
                        
                        <h4 style="color: #333; margin: 16px 0 8px 0;">3. æ•°æ®å®‰å…¨è´£ä»»</h4>
                        <p>æ‚¨ç†è§£å¹¶åŒæ„ï¼Œæ•°æ®å®‰å…¨çš„ä¸»è¦è´£ä»»åœ¨äºæ‚¨è‡ªå·±ã€‚è¯·å¦¥å–„ä¿ç®¡æ‚¨çš„è®¾å¤‡å’Œè®¿é—®æƒé™ã€‚</p>
                        
                        <h4 style="color: #333; margin: 16px 0 8px 0;">4. æœåŠ¡å˜æ›´</h4>
                        <p>æˆ‘ä»¬ä¿ç•™éšæ—¶ä¿®æ”¹æˆ–ç»ˆæ­¢æœ¬æœåŠ¡çš„æƒåˆ©ï¼Œæ•ä¸å¦è¡Œé€šçŸ¥ã€‚</p>
                        
                        <h4 style="color: #333; margin: 16px 0 8px 0;">5. åè®®æ›´æ–°</h4>
                        <p>æˆ‘ä»¬å¯èƒ½ä¼šä¸æ—¶æ›´æ–°æœ¬ç”¨æˆ·åè®®ï¼Œæ›´æ–°åçš„åè®®å°†åœ¨åº”ç”¨ä¸­å‘å¸ƒã€‚</p>
                        
                        <h4 style="color: #333; margin: 16px 0 8px 0;">6. ç‰ˆæƒå£°æ˜</h4>
                        <p>æœ¬åº”ç”¨åŠå…¶æ‰€æœ‰å†…å®¹å‡å—ç‰ˆæƒæ³•ä¿æŠ¤ï¼Œæœªç»æˆæƒä¸å¾—å¤åˆ¶æˆ–åˆ†å‘ã€‚ Â©2025 æˆ‘çš„ä¸–ç•ŒæäºŒç‹—</p>
                    </div>
                `;
            }
            
            text.innerHTML = `<div class="agreement-title">${type === 'privacy' ? 'éšç§åè®®' : 'ç”¨æˆ·åè®®'}</div>${content}`;
        }

        function acceptAgreement() {
            localStorage.setItem('agreementAccepted', 'true');
            isAgreementAccepted = true;
            document.getElementById('agreementModal').classList.remove('active');
            setupEventListeners();
            renderPasswords();
            updateTabBar();
        }

        function disagreeAgreement() {
            document.body.innerHTML = '<div style="display: flex; align-items: center; justify-content: center; height: 100vh; color: #666; font-size: 18px; text-align: center;">æ‚¨å·²æ‹’ç»ä½¿ç”¨åè®®ï¼Œåº”ç”¨å°†æ— æ³•è¿è¡Œ</div>';
        }

        // è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
        function setupEventListeners() {
            // æ ‡ç­¾æ åˆ‡æ¢
            document.querySelectorAll('.tab-item').forEach(item => {
                item.addEventListener('click', () => {
                    const page = item.dataset.page;
                    switchPage(page);
                });
            });

            // æ·»åŠ å¯†ç æŒ‰é’®
            document.getElementById('addPasswordBtn').addEventListener('click', () => {
                openCreatePasswordModal();
            });

            // å¯†ç è¡¨å•æäº¤
            document.getElementById('passwordForm').addEventListener('submit', handlePasswordSubmit);

            // æ¨¡æ€æ¡†æŒ‰é’®
            document.getElementById('cancelBtn').addEventListener('click', closeCreatePasswordModal);
            document.getElementById('generatePasswordBtn').addEventListener('click', generateRandomPassword);
            document.getElementById('saveRandomPasswordBtn').addEventListener('click', saveRandomPassword);
            document.getElementById('dontSaveRandomBtn').addEventListener('click', () => {
                document.getElementById('generatedPasswordContainer').style.display = 'none';
            });

            // æ£€æŸ¥æ›´æ–°
            document.getElementById('checkUpdateBtn').addEventListener('click', checkForUpdates);

            // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.classList.remove('active');
                    }
                });
            });
        }

        // é¡µé¢åˆ‡æ¢
        function switchPage(page) {
            // æ›´æ–°æ ‡ç­¾æ çŠ¶æ€
            document.querySelectorAll('.tab-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`[data-page="${page}"]`).classList.add('active');

            // åˆ‡æ¢é¡µé¢
            document.querySelectorAll('.page').forEach(p => {
                p.classList.remove('active');
            });
            document.getElementById(page + 'Page').classList.add('active');

            // æ›´æ–°å½“å‰é¡µé¢
            if (page === 'home') {
                renderPasswords();
            }
        }

        // æ›´æ–°æ ‡ç­¾æ 
        function updateTabBar() {
            // æ ‡ç­¾æ å·²åœ¨switchPageä¸­å¤„ç†
        }

        // æ‰“å¼€åˆ›å»ºå¯†ç æ¨¡æ€æ¡†
        function openCreatePasswordModal() {
            currentEditingPassword = null;
            document.getElementById('passwordForm').reset();
            document.getElementById('passwordStrength').textContent = '';
            document.getElementById('createPasswordModal').classList.add('active');
        }

        // å…³é—­åˆ›å»ºå¯†ç æ¨¡æ€æ¡†
        function closeCreatePasswordModal() {
            document.getElementById('createPasswordModal').classList.remove('active');
        }

        // å¤„ç†å¯†ç æäº¤
        function handlePasswordSubmit(e) {
            e.preventDefault();
            
            const siteName = document.getElementById('siteName').value.trim();
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            const notes = document.getElementById('notes').value.trim();

            if (!siteName || !username || !password) {
                alert('è¯·å¡«å†™å¿…å¡«å­—æ®µ');
                return;
            }

            const newPassword = {
                id: currentEditingPassword ? currentEditingPassword.id : Date.now(),
                siteName,
                username,
                password,
                notes,
                createdAt: currentEditingPassword ? currentEditingPassword.createdAt : new Date().toISOString()
            };

            if (currentEditingPassword) {
                // ç¼–è¾‘ç°æœ‰å¯†ç 
                const index = passwords.findIndex(p => p.id === currentEditingPassword.id);
                passwords[index] = newPassword;
            } else {
                // æ·»åŠ æ–°å¯†ç 
                passwords.push(newPassword);
            }

            localStorage.setItem('passwords', JSON.stringify(passwords));
            closeCreatePasswordModal();
            renderPasswords();
        }

        // æ¸²æŸ“å¯†ç åˆ—è¡¨
        function renderPasswords() {
            const container = document.getElementById('passwordList');
            
            if (passwords.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 60px 20px; color: #666;">
                        <div style="font-size: 48px; margin-bottom: 16px;">ğŸ”’</div>
                        <div style="font-size: 18px; margin-bottom: 8px;">è¿˜æ²¡æœ‰ä¿å­˜çš„å¯†ç </div>
                        <div style="font-size: 14px; color: #999;">ç‚¹å‡»å³ä¸‹è§’çš„ + æŒ‰é’®åˆ›å»ºç¬¬ä¸€ä¸ªå¯†ç </div>
                    </div>
                `;
                return;
            }

            container.innerHTML = passwords.map(password => `
                <div class="password-card">
                    <div class="card-header">
                        <div>
                            <div class="site-name">${password.siteName}</div>
                            ${password.notes ? `<div style="font-size: 12px; color: #999; margin-bottom: 8px;">${password.notes}</div>` : ''}
                        </div>
                        <button class="delete-btn" onclick="deletePassword(${password.id})">åˆ é™¤</button>
                    </div>
                    <div class="password-info">
                        ç”¨æˆ·å: ${password.username}<br>
                        åˆ›å»ºæ—¶é—´: ${new Date(password.createdAt).toLocaleDateString()}
                    </div>
                    <div class="password-display">${'*'.repeat(password.password.length)}</div>
                    <div class="card-actions">
                        <button class="action-btn" onclick="copyToClipboard('${password.username}')">å¤åˆ¶ç”¨æˆ·å</button>
                        <button class="action-btn primary" onclick="showPasswordDetail(${password.id})">æŸ¥çœ‹å¯†ç </button>
                    </div>
                </div>
            `).join('');
        }

        // æ˜¾ç¤ºå¯†ç è¯¦æƒ…
        function showPasswordDetail(id) {
            const password = passwords.find(p => p.id === id);
            if (password) {
                const passwordToShow = password.password;
                if (confirm(`ç½‘ç«™/åº”ç”¨: ${password.siteName}\nç”¨æˆ·å: ${password.username}\nå¯†ç : ${passwordToShow}\n\nç‚¹å‡»ç¡®å®šå¤åˆ¶å¯†ç åˆ°å‰ªè´´æ¿`)) {
                    copyToClipboard(passwordToShow);
                }
            }
        }

        // å¤åˆ¶åˆ°å‰ªè´´æ¿
        function copyToClipboard(text) {
            if (navigator.clipboard) {
                navigator.clipboard.writeText(text).then(() => {
                    alert('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
                }).catch(() => {
                    fallbackCopyTextToClipboard(text);
                });
            } else {
                fallbackCopyTextToClipboard(text);
            }
        }

        // å¤‡ç”¨å¤åˆ¶æ–¹æ³•
        function fallbackCopyTextToClipboard(text) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            textArea.style.top = "0";
            textArea.style.left = "0";
            textArea.style.position = "fixed";
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
                document.execCommand('copy');
                alert('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
            } catch (err) {
                alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶');
            }
            
            document.body.removeChild(textArea);
        }

        // åˆ é™¤å¯†ç 
        function deletePassword(id) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå¯†ç å—ï¼Ÿ')) {
                passwords = passwords.filter(p => p.id !== id);
                localStorage.setItem('passwords', JSON.stringify(passwords));
                renderPasswords();
            }
        }

        // ç”Ÿæˆéšæœºå¯†ç 
        function generateRandomPassword() {
            const length = 12;
            const charset = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@#$%&*";
            let password = "";
            
            for (let i = 0; i < length; i++) {
                password += charset.charAt(Math.floor(Math.random() * charset.length));
            }
            
            document.getElementById('generatedPassword').textContent = password;
            document.getElementById('generatedPasswordContainer').style.display = 'block';
            
            // ä¿å­˜å½“å‰ç”Ÿæˆçš„å¯†ç ä¾›ä¿å­˜ä½¿ç”¨
            window.currentGeneratedPassword = {
                password: password,
                siteName: 'éšæœºç”Ÿæˆ',
                username: 'ç”¨æˆ·' + Math.floor(Math.random() * 1000),
                notes: 'éšæœºç”Ÿæˆçš„å¯†ç '
            };
        }

        // ä¿å­˜éšæœºå¯†ç 
        function saveRandomPassword() {
            if (window.currentGeneratedPassword) {
                const passwordData = {
                    id: Date.now(),
                    siteName: window.currentGeneratedPassword.siteName,
                    username: window.currentGeneratedPassword.username,
                    password: window.currentGeneratedPassword.password,
                    notes: window.currentGeneratedPassword.notes,
                    createdAt: new Date().toISOString()
                };
                
                passwords.push(passwordData);
                localStorage.setItem('passwords', JSON.stringify(passwords));
                renderPasswords();
                
                document.getElementById('generatedPasswordContainer').style.display = 'none';
                window.currentGeneratedPassword = null;
            }
        }

        // æ£€æŸ¥æ›´æ–°
        function checkForUpdates() {
            alert('å½“å‰ç‰ˆæœ¬v1.0 è¯·å‰å¾€legmc1.netlify.appæ‰‹åŠ¨æ£€æŸ¥æ›´æ–°\n\nåŠŸèƒ½ç‰¹ç‚¹ï¼š\nâ€¢ æœ¬åœ°å­˜å‚¨å¯†ç æ•°æ®\nâ€¢ ç”Ÿæˆéšæœºå¯†ç \nâ€¢ å¯†ç ç®¡ç†\nâ€¢ æ•°æ®å®‰å…¨å­˜å‚¨åœ¨æ‚¨çš„è®¾å¤‡ä¸Š');
        }

        // ç‚¹å‡» + æŒ‰é’®
        document.getElementById('addPasswordBtn').addEventListener('click', () => {
            openCreatePasswordModal();
        });
    </script>
</body>
</html>
